<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kartal.AI Chatbot - System Architecture</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        .ascii-diagram {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            overflow-x: auto;
            white-space: pre;
            margin: 20px 0;
        }
        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .component-box {
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            background: #ecf0f1;
        }
        .component-box h4 {
            color: #2c3e50;
            margin-top: 0;
            border-bottom: 1px solid #bdc3c7;
            padding-bottom: 5px;
        }
        .flow-step {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
        }
        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        .tech-item {
            background: #e74c3c;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }
        .endpoint-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .endpoint-table th,
        .endpoint-table td {
            border: 1px solid #bdc3c7;
            padding: 12px;
            text-align: left;
        }
        .endpoint-table th {
            background: #3498db;
            color: white;
        }
        .endpoint-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        .highlight-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .page-break {
            page-break-before: always;
        }
        @media print {
            body { background: white; }
            .container { box-shadow: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🤖 Kartal.AI Chatbot - System Architecture</h1>
        
        <div class="highlight-box">
            <strong>Project Overview:</strong> RAG-based AI chatbot platform for hospitality industry using FastAPI, AWS Bedrock Claude, LlamaIndex, and ChromaDB vector database.
        </div>

        <h2>📊 System Architecture Diagram</h2>
        <div class="ascii-diagram">┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   User/Client   │───▶│   Nginx Proxy    │───▶│   FastAPI App   │
│   (Browser)     │    │  (SSL/HTTPS)     │    │   (Port 8000)   │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                                                         │
                                                         ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Google Sheets │◀───│   Agent Module   │───▶│  LlamaIndex RAG │
│   (Logging)     │    │  (run_agent)     │    │    Pipeline     │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                                                         │
                                                         ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Redis Cache   │◀───│   Session Mgmt   │    │   ChromaDB      │
│  (Optional)     │    │   & State        │    │ Vector Store    │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                                                         │
                                                         ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│  HuggingFace    │───▶│   Embeddings     │    │   AWS Bedrock   │
│  Transformers   │    │   Processing     │    │   Claude LLM    │
└─────────────────┘    └──────────────────┘    └─────────────────┘</div>

        <h2>🔄 Data Flow Process</h2>
        <div style="text-align: center; margin: 20px 0;">
            <div class="flow-step">1. User Request</div>
            <div class="flow-step">2. Nginx Proxy</div>
            <div class="flow-step">3. FastAPI Validation</div>
            <div class="flow-step">4. RAG Processing</div>
            <div class="flow-step">5. Vector Search</div>
            <div class="flow-step">6. LLM Generation</div>
            <div class="flow-step">7. Response & Logging</div>
        </div>

        <h2>🏗️ System Components</h2>
        <div class="component-grid">
            <div class="component-box">
                <h4>🌐 Frontend Layer</h4>
                <ul>
                    <li><strong>Nginx:</strong> Reverse proxy, SSL termination</li>
                    <li><strong>CORS:</strong> Cross-origin request handling</li>
                    <li><strong>SSL/TLS:</strong> Encrypted communication</li>
                </ul>
            </div>
            
            <div class="component-box">
                <h4>📡 API Layer</h4>
                <ul>
                    <li><strong>FastAPI:</strong> High-performance REST API</li>
                    <li><strong>Pydantic:</strong> Request/response validation</li>
                    <li><strong>Middleware:</strong> CORS, logging, error handling</li>
                </ul>
            </div>
            
            <div class="component-box">
                <h4>🤖 AI/ML Layer</h4>
                <ul>
                    <li><strong>LlamaIndex:</strong> RAG pipeline orchestration</li>
                    <li><strong>AWS Bedrock:</strong> Claude 3.5 Sonnet LLM</li>
                    <li><strong>HuggingFace:</strong> Sentence transformers</li>
                </ul>
            </div>
            
            <div class="component-box">
                <h4>🗄️ Data Layer</h4>
                <ul>
                    <li><strong>ChromaDB:</strong> Vector database</li>
                    <li><strong>Redis:</strong> Session management (optional)</li>
                    <li><strong>Google Sheets:</strong> Chat logging</li>
                </ul>
            </div>
            
            <div class="component-box">
                <h4>☁️ Infrastructure</h4>
                <ul>
                    <li><strong>AWS EC2:</strong> Compute instance</li>
                    <li><strong>systemd:</strong> Service management</li>
                    <li><strong>Cron Jobs:</strong> Automated maintenance</li>
                </ul>
            </div>
            
            <div class="component-box">
                <h4>🔒 Security & Compliance</h4>
                <ul>
                    <li><strong>KVKV/GDPR:</strong> Privacy compliant</li>
                    <li><strong>Data Masking:</strong> PII protection</li>
                    <li><strong>Log Rotation:</strong> 90-day retention</li>
                </ul>
            </div>
        </div>

        <div class="page-break"></div>

        <h2>🛠️ Technology Stack</h2>
        <div class="tech-stack">
            <span class="tech-item">FastAPI</span>
            <span class="tech-item">Python</span>
            <span class="tech-item">AWS Bedrock</span>
            <span class="tech-item">Claude 3.5</span>
            <span class="tech-item">LlamaIndex</span>
            <span class="tech-item">ChromaDB</span>
            <span class="tech-item">HuggingFace</span>
            <span class="tech-item">Redis</span>
            <span class="tech-item">Nginx</span>
            <span class="tech-item">EC2</span>
            <span class="tech-item">systemd</span>
            <span class="tech-item">pytest</span>
        </div>

        <h2>🔌 API Endpoints</h2>
        <table class="endpoint-table">
            <thead>
                <tr>
                    <th>Endpoint</th>
                    <th>Method</th>
                    <th>Purpose</th>
                    <th>Request Format</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>/welcome</td>
                    <td>GET</td>
                    <td>Welcome message & health check</td>
                    <td>No body required</td>
                </tr>
                <tr>
                    <td>/chat</td>
                    <td>POST</td>
                    <td>Main chat interface with sessions</td>
                    <td>{"user_id", "session_id", "message"}</td>
                </tr>
                <tr>
                    <td>/rag-query</td>
                    <td>POST</td>
                    <td>Direct RAG query without session</td>
                    <td>{"soru": "question"}</td>
                </tr>
                <tr>
                    <td>/health</td>
                    <td>GET</td>
                    <td>System health status</td>
                    <td>No body required</td>
                </tr>
                <tr>
                    <td>/test-redis</td>
                    <td>GET</td>
                    <td>Redis connectivity test</td>
                    <td>No body required</td>
                </tr>
                <tr>
                    <td>/test-bedrock</td>
                    <td>GET</td>
                    <td>AWS Bedrock connectivity test</td>
                    <td>No body required</td>
                </tr>
            </tbody>
        </table>

        <h2>🔄 RAG Pipeline Process</h2>
        <div class="ascii-diagram">User Query
    │
    ▼
┌─────────────────┐
│  Text Embedding │ ← HuggingFace Transformers
│  (Vectorization)│   (sentence-transformers/all-MiniLM-L6-v2)
└─────────────────┘
    │
    ▼
┌─────────────────┐
│  Vector Search  │ ← ChromaDB Vector Database
│  (Similarity)   │   (Semantic similarity matching)
└─────────────────┘
    │
    ▼
┌─────────────────┐
│ Context Retrieval│ ← Relevant documents/chunks
│  (Top-K Results)│   (Most similar content)
└─────────────────┘
    │
    ▼
┌─────────────────┐
│  LLM Generation │ ← AWS Bedrock Claude 3.5 Sonnet
│  (Augmented)    │   (Context + Query → Response)
└─────────────────┘
    │
    ▼
Final Response</div>

        <h2>📈 Key Features & Benefits</h2>
        <div class="component-grid">
            <div class="component-box">
                <h4>🚀 Performance</h4>
                <ul>
                    <li>FastAPI async processing</li>
                    <li>Vector database optimization</li>
                    <li>Redis caching layer</li>
                    <li>Nginx load balancing</li>
                </ul>
            </div>
            
            <div class="component-box">
                <h4>🔒 Security</h4>
                <ul>
                    <li>SSL/TLS encryption</li>
                    <li>CORS protection</li>
                    <li>PII data masking</li>
                    <li>AWS IAM integration</li>
                </ul>
            </div>
            
            <div class="component-box">
                <h4>📊 Monitoring</h4>
                <ul>
                    <li>Comprehensive logging</li>
                    <li>Google Sheets analytics</li>
                    <li>Health check endpoints</li>
                    <li>Automated log rotation</li>
                </ul>
            </div>
            
            <div class="component-box">
                <h4>⚙️ DevOps</h4>
                <ul>
                    <li>systemd service management</li>
                    <li>Automated deployments</li>
                    <li>Cron job maintenance</li>
                    <li>Environment configuration</li>
                </ul>
            </div>
        </div>

        <div class="highlight-box">
            <h3>🎯 Project Highlights</h3>
            <ul>
                <li><strong>Production-Ready:</strong> Deployed on AWS EC2 with proper service management</li>
                <li><strong>Scalable Architecture:</strong> Microservices approach with clear separation of concerns</li>
                <li><strong>AI-Powered:</strong> Advanced RAG implementation with state-of-the-art LLM</li>
                <li><strong>Compliance-First:</strong> KVKV/GDPR compliant with automated data management</li>
                <li><strong>Full-Stack:</strong> From infrastructure to AI, comprehensive technical implementation</li>
            </ul>
        </div>
    </div>
</body>
</html>